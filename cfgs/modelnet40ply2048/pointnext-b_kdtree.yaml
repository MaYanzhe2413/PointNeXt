# PointNeXt-B (Base) with KDTree Sampling for ModelNet40
# Enhanced version with larger capacity and KDTree sampling
# Designed for higher accuracy while maintaining efficiency

# Original PointNeXt-B Performance (adapted from S3DIS config):
# GFLOPs: ~8.94, GMACs: ~4.41, Params: ~3.83M
# Expected improvements with KDTree sampling

model:
  NAME: BaseCls
  encoder_args:
    NAME: PointNextEncoder
    blocks: [1, 2, 3, 2, 2]              # æ›´æ·±çš„ç½‘ç»œç»“æ„
    strides: [1, 2, 2, 2, 2]             # æ¸è¿›å¼ä¸‹é‡‡æ ·
    sa_layers: 2                         # Set Abstractionå±‚æ•°
    sa_use_res: True                     # ä½¿ç”¨æ®‹å·®è¿æ¥
    width: 64                            # æ›´å¤§çš„åŸºç¡€é€šé“æ•°
    in_channels: 3                       # è¾“å…¥ç»´åº¦ (x, y, z)
    expansion: 4                         # MLPæ‰©å±•å› å­
    radius: 0.1                          # çƒæŸ¥è¯¢åŠå¾„
    radius_scaling: 2.0                  # æ›´å¤§çš„åŠå¾„ç¼©æ”¾
    nsample: 32                          # é‚»å±…é‡‡æ ·æ•°
    sampler: kdtree                      # ğŸŒ³ ä½¿ç”¨KDTreeé‡‡æ ·
    aggr_args:
      feature_type: 'dp_fj'              # è·ç¦»+ä½ç½®+ç‰¹å¾+æ‹¼æ¥
      reduction: 'max'                   # æœ€å¤§æ± åŒ–èšåˆ
    group_args:
      NAME: 'ballquery'                  # çƒæŸ¥è¯¢åˆ†ç»„
      normalize_dp: True                 # å½’ä¸€åŒ–è·ç¦»-ä½ç½®ç‰¹å¾
    conv_args:
      order: conv-norm-act               # å·ç§¯å±‚é¡ºåº
    act_args:
      act: 'relu'                        # ReLUæ¿€æ´»
    norm_args:
      norm: 'bn'                         # æ‰¹å½’ä¸€åŒ–
  cls_args: 
    NAME: ClsHead
    num_classes: 40                      # ModelNet40ç±»åˆ«æ•°
    mlps: [1024, 512, 256]               # æ›´å¤§çš„åˆ†ç±»å¤´
    norm_args: 
      norm: 'bn1d'                       # 1Dæ‰¹å½’ä¸€åŒ–

# KDTreeé‡‡æ ·ä¼˜åŒ–é…ç½®
# å¤šå±‚æ¬¡é‡‡æ ·ç­–ç•¥:
# Layer 1: 1024 â†’ 512 points (32 leaf nodes, 16 points each)
# Layer 2: 512 â†’ 256 points (16 leaf nodes, 16 points each)  
# Layer 3: 256 â†’ 128 points (8 leaf nodes, 16 points each)
# Layer 4: 128 â†’ 64 points (4 leaf nodes, 16 points each)
# Layer 5: 64 â†’ 1 point (global pooling)

# é¢„æœŸæ€§èƒ½æå‡:
# âœ… é‡‡æ ·é€Ÿåº¦: ~128å€æå‡
# âœ… æ¨¡å‹å®¹é‡: æ¯”PointNeXt-Sæ›´å¤§
# âœ… ç©ºé—´è¦†ç›–: KDTreeä¿è¯å‡åŒ€åˆ†å¸ƒ
# âœ… å¹¶è¡Œå¤„ç†: å¤šå¶èŠ‚ç‚¹å¹¶è¡ŒFPS