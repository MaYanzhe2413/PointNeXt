# PointNeXt-S with Adaptive KDTree Sampling
# Advanced version with density-aware adaptive sampling
# Optimized for complex point cloud distributions

model:
  NAME: BaseCls
  encoder_args:
    NAME: PointNextEncoder
    blocks: [1, 1, 1, 1, 1, 1]           # æ ‡å‡†6å±‚ç»“æ„
    strides: [1, 2, 2, 2, 2, 1]          # ä¸‹é‡‡æ ·ç­–ç•¥
    width: 32                            # åŸºç¡€é€šé“æ•°
    in_channels: 3                       # è¾“å…¥ç»´åº¦
    radius: 0.15                         # çƒæŸ¥è¯¢åŠå¾„
    radius_scaling: 1.5                  # åŠå¾„ç¼©æ”¾
    sa_layers: 2                         # Set Abstractionå±‚æ•°
    sa_use_res: True                     # æ®‹å·®è¿æ¥
    nsample: 32                          # é‚»å±…æ•°é‡
    expansion: 4                         # MLPæ‰©å±•
    sampler: kdtree_adaptive             # ğŸ§  è‡ªé€‚åº”KDTreeé‡‡æ ·
    aggr_args:
      feature_type: 'dp_fj'              # å®Œæ•´ç‰¹å¾ç±»å‹
      reduction: 'max'                   # æœ€å¤§æ± åŒ–
    group_args:
      NAME: 'ballquery'                  # çƒæŸ¥è¯¢
      normalize_dp: True                 # ç‰¹å¾å½’ä¸€åŒ–
    conv_args:
      order: conv-norm-act               # æ ‡å‡†å·ç§¯é¡ºåº
    act_args:
      act: 'relu'                        # ReLUæ¿€æ´»
    norm_args:
      norm: 'bn'                         # æ‰¹å½’ä¸€åŒ–
  cls_args: 
    NAME: ClsHead
    num_classes: 40                      # ModelNet40åˆ†ç±»
    mlps: [512, 256]                     # åˆ†ç±»å¤´ç»´åº¦
    norm_args: 
      norm: 'bn1d'                       # 1Dæ‰¹å½’ä¸€åŒ–

# é«˜çº§KDTreeé…ç½®è¯´æ˜:
# 
# ğŸ§  è‡ªé€‚åº”é‡‡æ ·ç‰¹æ€§:
# - å¯†åº¦æ„ŸçŸ¥: é«˜å¯†åº¦åŒºåŸŸé‡‡æ ·æ›´å¤šç‚¹
# - å‡ ä½•æ„ŸçŸ¥: æ›²ç‡é«˜çš„åŒºåŸŸä¼˜å…ˆé‡‡æ ·
# - è¾¹ç•Œä¿æŠ¤: ç‰©ä½“è¾¹ç•ŒåŒºåŸŸé‡ç‚¹é‡‡æ ·
# 
# ğŸŒ³ KDTreeç»“æ„ä¼˜åŒ–:
# - åŠ¨æ€å¶èŠ‚ç‚¹å¤§å°: æ ¹æ®å±€éƒ¨å¯†åº¦è°ƒæ•´
# - å¤šå°ºåº¦åˆ†æ: ä¸åŒå±‚æ¬¡ä½¿ç”¨ä¸åŒleaf_size
# - è´Ÿè½½å‡è¡¡: ç¡®ä¿å„å¶èŠ‚ç‚¹é‡‡æ ·æ•°é‡å¹³è¡¡
#
# âš¡ æ€§èƒ½ä¼˜åŒ–:
# - å¹¶è¡Œå¤„ç†: 32-64ä¸ªå¶èŠ‚ç‚¹å¹¶è¡Œ
# - å†…å­˜ä¼˜åŒ–: å‡å°‘ä¸­é—´tensorå­˜å‚¨
# - ç¼“å­˜æœºåˆ¶: é‡ç”¨KDTreeç»“æ„
#
# ğŸ¯ é€‚ç”¨åœºæ™¯:
# - å¤æ‚å‡ ä½•å½¢çŠ¶ (å¦‚æ¤…å­ã€é£æœº)
# - ä¸å‡åŒ€å¯†åº¦åˆ†å¸ƒ
# - ç²¾ç»†ç‰¹å¾ä¿æŒè¦æ±‚é«˜çš„ä»»åŠ¡