# PointNeXt-S with KDTree Sampling for ModelNet40
# Based on the original PointNeXt-S configuration with KDTree sampling integration
# Performance improvements expected due to efficient spatial sampling

# Original PointNeXt-S Performance:
# GFLOPs: 1.64, GMACs: 0.81, Params: 1.374M
# Throughput: ~2033 ins./s

# KDTree Enhanced Configuration:
# - Replaces FPS with KDTree-based leaf node FPS sampling
# - Expected ~128x speedup in sampling phase
# - Maintains spatial quality while improving efficiency

model:
  NAME: BaseCls
  encoder_args:
    NAME: PointNextEncoder
    blocks: [1, 1, 1, 1, 1, 1]            # 6å±‚ç»“æ„
    strides: [1, 2, 2, 2, 2, 1]           # ä¸‹é‡‡æ ·æ¯”ç‡
    width: 32                             # åŸºç¡€é€šé“æ•°
    in_channels: 3                        # è¾“å…¥ç»´åº¦ (x, y, z)
    radius: 0.15                          # çƒæŸ¥è¯¢åŠå¾„
    radius_scaling: 1.5                   # åŠå¾„ç¼©æ”¾å› å­
    sa_layers: 2                          # Set Abstractionå±‚æ•°
    sa_use_res: True                      # ä½¿ç”¨æ®‹å·®è¿æ¥
    nsample: 32                           # é‚»å±…é‡‡æ ·æ•°
    expansion: 4                          # MLPæ‰©å±•å› å­
    sampler: kdtree                       # ğŸŒ³ ä½¿ç”¨KDTreeé‡‡æ · (å…³é”®é…ç½®)
    aggr_args:
      feature_type: 'dp_fj'               # ç‰¹å¾ç±»å‹ï¼šè·ç¦»+ä½ç½®+ç‰¹å¾+æ‹¼æ¥
      reduction: 'max'                    # ç‰¹å¾èšåˆæ–¹å¼
    group_args:
      NAME: 'ballquery'                   # ä½¿ç”¨çƒæŸ¥è¯¢åˆ†ç»„
      normalize_dp: True                  # å½’ä¸€åŒ–è·ç¦»-ä½ç½®ç‰¹å¾
    conv_args:
      order: conv-norm-act                # å·ç§¯å±‚é¡ºåº
    act_args:
      act: 'relu'                         # æ¿€æ´»å‡½æ•°
    norm_args:
      norm: 'bn'                          # æ‰¹å½’ä¸€åŒ–
  cls_args: 
    NAME: ClsHead
    num_classes: 40                       # ModelNet40ç±»åˆ«æ•°
    mlps: [512, 256]                      # åˆ†ç±»å¤´MLPç»´åº¦
    norm_args: 
      norm: 'bn1d'                        # 1Dæ‰¹å½’ä¸€åŒ–

# KDTreeé‡‡æ ·ç›¸å…³é…ç½® (éšå¼å‚æ•°ï¼Œåœ¨kdsample.pyä¸­å®šä¹‰)
# kdtree_config:
#   leaf_size: 32                        # å¶èŠ‚ç‚¹æœ€å¤§å¤§å°
#   adaptive: False                      # æ˜¯å¦ä½¿ç”¨è‡ªé€‚åº”é‡‡æ ·
#   density_aware: False                 # æ˜¯å¦è€ƒè™‘å¯†åº¦

# è®­ç»ƒç›¸å…³é…ç½®ç»§æ‰¿è‡ªé»˜è®¤é…ç½®
# é¢„æœŸæ”¹è¿›:
# 1. é‡‡æ ·é˜¶æ®µé€Ÿåº¦æå‡ ~128å€
# 2. ä¿æŒåŸæœ‰åˆ†ç±»ç²¾åº¦
# 3. æ›´å¥½çš„ç©ºé—´åˆ†å¸ƒå‡åŒ€æ€§
# 4. æ”¯æŒå¹¶è¡ŒåŒ–å¤„ç† (32ä¸ªå¶èŠ‚ç‚¹å¹¶è¡Œ)