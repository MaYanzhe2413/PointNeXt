from collections import OrderedDict
import math

def point_config_from_model(batch_size=1):
    points = [24000, 6000, 1500, 375, 93]
    grouped_points_default = 32
    cfg = OrderedDict([
        ('conv2d0-1', [points[0], 1, 4, 32, 1, 0, 1, batch_size]),
        ('grouper1', [points[0], points[1], batch_size, 32, 0.1]),
        ('conv2d1-1', [points[1], 32, 35, 32, 1, 0, 1, batch_size]),
        ('bn1-1', []),
        ('relu1-1', []),
        ('conv2d1-2', [points[1], 32, 32, 64, 1, 0, 1, batch_size]),
        ('bn1-2', []),
        ('relu1-2', []),
        ('maxpool1', [points[1], 32, 64, 1, 0, 1, batch_size]),
        ('skip1', [points[1], 1, 32, 64, 1, 0, 1, batch_size]),
        ('add1', [points[1], 1, 64]),
        ('grouper2', [points[1], points[2], batch_size, 32, 0.2]),
        ('conv2d2-1', [points[2], 32, 67, 64, 1, 0, 1, batch_size]),
        ('bn2-1', []),
        ('relu2-1', []),
        ('conv2d2-2', [points[2], 32, 64, 128, 1, 0, 1, batch_size]),
        ('bn2-2', []),
        ('relu2-2', []),
        ('maxpool2', [points[2], 32, 128, 1, 0, 1, batch_size]),
        ('skip2', [points[2], 1, 64, 128, 1, 0, 1, batch_size]),
        ('add2', [points[2], 1, 128]),
        ('grouper3', [points[2], points[3], batch_size, 32, 0.4]),
        ('conv2d3-1', [points[3], 32, 131, 128, 1, 0, 1, batch_size]),
        ('bn3-1', []),
        ('relu3-1', []),
        ('conv2d3-2', [points[3], 32, 128, 256, 1, 0, 1, batch_size]),
        ('bn3-2', []),
        ('relu3-2', []),
        ('maxpool3', [points[3], 32, 256, 1, 0, 1, batch_size]),
        ('skip3', [points[3], 1, 128, 256, 1, 0, 1, batch_size]),
        ('add3', [points[3], 1, 256]),
        ('grouper4', [points[3], points[4], batch_size, 32, 0.8]),
        ('conv2d4-1', [points[4], 32, 259, 256, 1, 0, 1, batch_size]),
        ('bn4-1', []),
        ('relu4-1', []),
        ('conv2d4-2', [points[4], 32, 256, 512, 1, 0, 1, batch_size]),
        ('bn4-2', []),
        ('relu4-2', []),
        ('maxpool4', [points[4], 32, 512, 1, 0, 1, batch_size]),
        ('skip4', [points[4], 1, 256, 512, 1, 0, 1, batch_size]),
        ('add4', [points[4], 1, 512]),
        ('threenn1', [points[4], points[3], batch_size, 1.0, None, [False, False, False, False], 64, 512]),
        ('conv2d_fp1-1', [points[3], 1, 768, 256, 1, 0, 1, batch_size]),
        ('bn_fp1-1', []),
        ('relu_fp1-1', []),
        ('conv2d_fp1-2', [points[3], 1, 256, 256, 1, 0, 1, batch_size]),
        ('bn_fp1-2', []),
        ('relu_fp1-2', []),
        ('threenn2', [points[3], points[2], batch_size, 1.0, None, [False, False, False, False], 64, 256]),
        ('conv2d_fp2-1', [points[2], 1, 384, 128, 1, 0, 1, batch_size]),
        ('bn_fp2-1', []),
        ('relu_fp2-1', []),
        ('conv2d_fp2-2', [points[2], 1, 128, 128, 1, 0, 1, batch_size]),
        ('bn_fp2-2', []),
        ('relu_fp2-2', []),
        ('threenn3', [points[2], points[1], batch_size, 1.0, None, [False, False, False, False], 64, 128]),
        ('conv2d_fp3-1', [points[1], 1, 192, 64, 1, 0, 1, batch_size]),
        ('bn_fp3-1', []),
        ('relu_fp3-1', []),
        ('conv2d_fp3-2', [points[1], 1, 64, 64, 1, 0, 1, batch_size]),
        ('bn_fp3-2', []),
        ('relu_fp3-2', []),
        ('threenn4', [points[1], points[0], batch_size, 1.0, None, [False, False, False, False], 64, 64]),
        ('conv2d_fp4-1', [points[0], 1, 96, 32, 1, 0, 1, batch_size]),
        ('bn_fp4-1', []),
        ('relu_fp4-1', []),
        ('conv2d_fp4-2', [points[0], 1, 32, 32, 1, 0, 1, batch_size]),
        ('bn_fp4-2', []),
        ('relu_fp4-2', []),
        ('conv2d_head1', [points[0], 1, 32, 32, 1, 0, 1, batch_size]),
        ('bn_head1', []),
        ('relu_head1', []),
        ('dropout_head', []),
        ('conv2d_head2', [points[0], 1, 32, 13, 1, 0, 1, batch_size]),
    ])
    return cfg